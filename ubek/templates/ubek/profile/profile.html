<!--
=========================================================
* BLK Design System- v1.0.0
=========================================================

* Product Page: https://www.creative-tim.com/product/blk-design-system
* Copyright 2019 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT

* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 -->
{% load static %}
<!DOCTYPE html>
<html lang="en">

<!-- HEAD -->
{% include 'ubek/login/head.html' %}
<!-- END HEAD -->

<body class="profile-page">
  <!-- Navbar -->
{% include 'ubek/login/navbar.html' %}
  <!-- End Navbar -->


  <!-- Profile Nav-->
{% include 'ubek/profile/profile_head.html' %}
  <!-- END Profile Nav

  <!-- Main -->



      <div class="col-sm-8">
      {% if show_profile == request.user %}
      <form method='POST' action="">
        {% autoescape off %}
        {% csrf_token %}
        <div class="card">
        <div class="card-body">
            <div>{{ form.user }}</div>
            <div>{{ form.title }}</div>
            <div style="display: inline-block;">{{ form.text }}</div>
            <div><button class="btn btn-primary" type="submit" name="Add Post">Add post</button></div>
        </div>
        </div>
        {% endautoescape %}
      </form>
      {% endif %}

         <div class="row">
            <div class="col text-right"><h2 class="text-muted">POSTS</h2></div>
         </div>


      <!-- POST -->
      {% for post in posts_order %}
      <div class="card">
        <div class="card-header row">
            <a href="{% url 'profile page' post.user.id %}">
             <img src="{{ post.user.profile.profile_photo.url }}"
                                       style="width: 50px;
                                              margin-left: 10px;
                                              margin-top: -10px;
                                              margin-right: -5px;
                                              height: 50px;
                                              border-radius: 50%;
                                              margin-bottom: 5px;"></a>
            <div class="col-sm-4"><a href="{% url 'profile page' post.user.id %}">{{ post.user.first_name }} {{ post.user.last_name }}</a></div>
            <div class="col-sm-7" align="right">{{ post.pub_date }} </div>
        </div>


        <div class="row" style="margin-left: 15px; margin-bottom: 0px;">
            <div class="col-sm-12"><h3>{{ post.title }}</h3></div>
        </div>


        <div class="card-body" style="margin-top: -35px;">
          <p>{{ post.text|truncatewords:80 }}</p>
        </div>

          {% if post.user == request.user and show_profile == request.user %}
        <div class="row" style="margin-right: 0px; margin-bottom: 5px;">
            <div class="col" align="right">
            <div class="btn-group">
            <button type="button" class="btn btn-default btn-icon dropdown-toggle btn-round" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="tim-icons icon-pencil"></i>
            </button>
            <div class="dropdown-menu">
                <a class="dropdown-item" data-toggle="modal" data-target="#editpost{{post.id}}" href="#">Edit</a>
                <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="/delete_post/{{ post.id }}/">Delete Post</a>

            </div>
            </div>
            </div>
        </div>
        {% endif %}


      <div class="modal fade modal-black" id="editpost{{post.id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" style="display: none;" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header justify-content-center">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                <i class="tim-icons icon-simple-remove text-white"></i>
              </button>
              <div class="text-muted text-center ml-auto mr-auto">
                <h3 class="mb-0">Edit post</h3>
              </div>
            </div>
            <div class="modal-body">
              <form method='POST' action="" enctype="multipart/form-data">
                  {% csrf_token %}
                <div class="form-group mb-3">
                  <div class="input-group input-group-alternative">
                    <input class="form-control" value="{{ post.title }}" name="{{ form_edit_post.title.name }}">
                  </div>
                </div>
                <div class="form-group">
                  <div class="input-group input-group-alternative">
                      <textarea class="form-control" name="{{ form_edit_post.text.name }}">{{ post.text }}</textarea>
                  </div>
                </div>
                <div class="text-center">
                  <button type="submit" class="btn btn-primary my-4" name="Edit Post" value="{{ post.id }}">Save</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      </div>
      {% endfor %}
     <!-- END POST -->
      </div>
  </div>
</div>
    </div>
<br><br>





  <!-- END Main -->

  <!-- modal -->
{% include 'ubek/login/modal.html' %}
  <!-- END modal -->


      <!-- Footer -->
{% include 'ubek/login/footer.html' %}
        <!-- END Footer -->
  </div>
  <!--   Core JS Files   -->
  {% include 'ubek/login/scripts.html' %}
  <!-- END Scripts -->
</body>

</html>
